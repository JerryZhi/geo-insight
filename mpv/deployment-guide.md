# GEO Insight MVP - éƒ¨ç½²å‰å‡†å¤‡æ¸…å•

## ğŸš€ ä¸€é”®éƒ¨ç½²è„šæœ¬ä½¿ç”¨æŒ‡å—

### ğŸ“‹ éƒ¨ç½²å‰å‡†å¤‡ï¼ˆå¿…é¡»å®Œæˆï¼‰

#### 1. æœåŠ¡å™¨å‡†å¤‡
- âœ… **äº‘æœåŠ¡å™¨**: å·²è´­ä¹°å¹¶é…ç½® Debian 10+ æˆ– Ubuntu 18.04+ æœåŠ¡å™¨
- âœ… **è§„æ ¼è¦æ±‚**: 
  - å†…å­˜: æœ€ä½ 1GBï¼Œæ¨è 2GB+
  - å­˜å‚¨: æœ€ä½ 10GBï¼Œæ¨è 20GB+
  - CPU: 1æ ¸å¿ƒä»¥ä¸Š
- âœ… **ç½‘ç»œ**: æœåŠ¡å™¨å…·å¤‡å…¬ç½‘ IP
- âœ… **SSH è®¿é—®**: å¯ä»¥é€šè¿‡ SSH è¿æ¥åˆ°æœåŠ¡å™¨
- âœ… **Root æƒé™**: ç¡®ä¿æœ‰ sudo æˆ– root æƒé™

#### 2. åŸŸåé…ç½®ï¼ˆæ¨èï¼‰
- âœ… **åŸŸå**: å·²è´­ä¹°åŸŸåï¼ˆå¦‚ï¼šexample.comï¼‰
- âœ… **DNS è§£æ**: å°†åŸŸå A è®°å½•æŒ‡å‘æœåŠ¡å™¨å…¬ç½‘ IP
  ```
  A    @              your-server-ip
  A    www            your-server-ip
  ```
- âœ… **åŸŸåç”Ÿæ•ˆ**: ç¡®è®¤åŸŸåè§£æå·²ç”Ÿæ•ˆ
  ```bash
  # æœ¬åœ°æµ‹è¯•
  nslookup your-domain.com
  ping your-domain.com
  ```

#### 3. é‚®ç®±å‡†å¤‡ï¼ˆSSL è¯ä¹¦ç”¨ï¼‰
- âœ… **æœ‰æ•ˆé‚®ç®±**: ç”¨äºç”³è¯· Let's Encrypt SSL è¯ä¹¦

### ğŸ”§ éƒ¨ç½²æ­¥éª¤

#### ç¬¬ä¸€æ­¥ï¼šä¿®æ”¹é…ç½®
1. **ç¼–è¾‘ deploy.sh è„šæœ¬**ï¼Œä¿®æ”¹é¡¶éƒ¨çš„é…ç½®å˜é‡ï¼š
   ```bash
   # åœ¨è„šæœ¬é¡¶éƒ¨ä¿®æ”¹è¿™äº›å€¼
   DOMAIN="your-domain.com"                    # æ”¹ä¸ºæ‚¨çš„åŸŸå
   EMAIL="your-email@example.com"              # æ”¹ä¸ºæ‚¨çš„é‚®ç®±
   # å…¶ä»–é…ç½®ä¿æŒé»˜è®¤å³å¯
   ```

#### ç¬¬äºŒæ­¥ï¼šä¸Šä¼ æ–‡ä»¶
1. **æ–¹æ³•ä¸€ï¼šä½¿ç”¨ scp ä¸Šä¼ **
   ```bash
   # åœ¨æœ¬åœ°æ‰§è¡Œï¼ˆWindows ç”¨æˆ·åœ¨ Git Bash ä¸­æ‰§è¡Œï¼‰
   scp -r mpv/* root@your-server-ip:/tmp/geo-insight/
   ```

2. **æ–¹æ³•äºŒï¼šä½¿ç”¨ Git ä»“åº“**
   ```bash
   # å…ˆå°†ä»£ç æ¨é€åˆ° Git ä»“åº“ï¼Œç„¶ååœ¨æœåŠ¡å™¨ä¸Šå…‹éš†
   git clone https://github.com/ä½ çš„ç”¨æˆ·å/geo-insight.git /tmp/geo-insight
   ```

#### ç¬¬ä¸‰æ­¥ï¼šè¿è¡Œéƒ¨ç½²è„šæœ¬
```bash
# è¿æ¥åˆ°æœåŠ¡å™¨
ssh root@your-server-ip

# è¿›å…¥ä»£ç ç›®å½•
cd /tmp/geo-insight

# ç»™è„šæœ¬æ‰§è¡Œæƒé™
chmod +x deploy.sh

# è¿è¡Œéƒ¨ç½²è„šæœ¬
sudo bash deploy.sh
```

### ğŸ“ é…ç½®è¯´æ˜

#### é»˜è®¤é…ç½®
```bash
# åº”ç”¨é…ç½®
DEPLOY_USER="geo-insight"                    # åº”ç”¨è¿è¡Œç”¨æˆ·
INSTALL_DIR="/opt/geo-insight"              # å®‰è£…ç›®å½•
APP_PORT="5000"                             # åº”ç”¨ç«¯å£

# å®‰å…¨é…ç½®
SECRET_KEY="$(openssl rand -base64 32)"      # è‡ªåŠ¨ç”Ÿæˆå®‰å…¨å¯†é’¥
```

#### å¯é€‰ä¿®æ”¹çš„é…ç½®
å¦‚æœéœ€è¦ï¼Œæ‚¨å¯ä»¥ä¿®æ”¹è¿™äº›é…ç½®ï¼š
- `DEPLOY_USER`: åº”ç”¨è¿è¡Œç”¨æˆ·å
- `INSTALL_DIR`: å®‰è£…ç›®å½•è·¯å¾„
- `APP_PORT`: åº”ç”¨ç«¯å£ï¼ˆé»˜è®¤5000ï¼Œnginxä¼šä»£ç†åˆ°80/443ï¼‰

### ğŸ” è„šæœ¬åŠŸèƒ½è¯¦è§£

#### è‡ªåŠ¨åŒ–å®‰è£…çš„ç»„ä»¶
1. **ç³»ç»Ÿç¯å¢ƒ**
   - æ›´æ–°ç³»ç»ŸåŒ…
   - å®‰è£… Python 3.9+
   - å®‰è£…å¿…è¦çš„å·¥å…·

2. **Web æœåŠ¡**
   - Nginx (åå‘ä»£ç†)
   - Gunicorn (WSGIæœåŠ¡å™¨)
   - Supervisor (è¿›ç¨‹ç®¡ç†)

3. **åº”ç”¨éƒ¨ç½²**
   - åˆ›å»ºä¸“ç”¨ç”¨æˆ·å’Œç›®å½•
   - å®‰è£… Python ä¾èµ–
   - é…ç½®ç”Ÿäº§ç¯å¢ƒ
   - åˆå§‹åŒ–æ•°æ®åº“

4. **å®‰å…¨é…ç½®**
   - é˜²ç«å¢™è®¾ç½®
   - SSL è¯ä¹¦ç”³è¯·
   - æ–‡ä»¶æƒé™é…ç½®

5. **ç›‘æ§ç»´æŠ¤**
   - å¥åº·æ£€æŸ¥è„šæœ¬
   - æ—¥å¿—è½®è½¬é…ç½®
   - è‡ªåŠ¨é‡å¯æœºåˆ¶

### âš ï¸ æ³¨æ„äº‹é¡¹

#### å¿…é¡»æ³¨æ„çš„äº‹é¡¹
1. **å¤‡ä»½ç°æœ‰æ•°æ®**: å¦‚æœæœåŠ¡å™¨ä¸Šæœ‰å…¶ä»–ç½‘ç«™ï¼Œè¯·å…ˆå¤‡ä»½
2. **ç«¯å£å†²çª**: ç¡®ä¿ç«¯å£ 80ã€443ã€5000 æœªè¢«å ç”¨
3. **åŸŸåè§£æ**: ç¡®ä¿åŸŸåå·²æ­£ç¡®è§£æåˆ°æœåŠ¡å™¨ IP
4. **ç½‘ç»œå®‰å…¨**: ç¡®ä¿æœåŠ¡å™¨å®‰å…¨ç»„/é˜²ç«å¢™å…è®¸ HTTP(80) å’Œ HTTPS(443) è®¿é—®

#### å¯èƒ½é‡åˆ°çš„é—®é¢˜
1. **æƒé™é—®é¢˜**: ç¡®ä¿ä½¿ç”¨ root æˆ–æœ‰ sudo æƒé™çš„ç”¨æˆ·
2. **ç½‘ç»œé—®é¢˜**: ç¡®ä¿æœåŠ¡å™¨å¯ä»¥è®¿é—®å¤–ç½‘ï¼ˆä¸‹è½½è½¯ä»¶åŒ…ï¼‰
3. **åŸŸåé—®é¢˜**: å¦‚æœåŸŸåæœªé…ç½®ï¼Œå¯ä»¥å…ˆä½¿ç”¨ IP è®¿é—®ï¼Œåç»­å†é…ç½®åŸŸå

### ğŸš€ éƒ¨ç½²åéªŒè¯

#### æ£€æŸ¥æœåŠ¡çŠ¶æ€
```bash
# æ£€æŸ¥åº”ç”¨çŠ¶æ€
sudo supervisorctl status geo-insight

# æ£€æŸ¥ Nginx çŠ¶æ€
sudo systemctl status nginx

# æ£€æŸ¥ç«¯å£ç›‘å¬
sudo netstat -tlnp | grep :5000
sudo netstat -tlnp | grep :80
```

#### è®¿é—®æµ‹è¯•
```bash
# æœ¬åœ°æµ‹è¯•
curl http://localhost/health

# è¿œç¨‹æµ‹è¯•
curl http://your-domain.com/health
```

### ğŸ“š éƒ¨ç½²åæ“ä½œ

#### 1. é¦–æ¬¡è®¿é—®
- è®¿é—® `http://your-domain.com` æˆ– `https://your-domain.com`
- æ³¨å†Œç®¡ç†å‘˜è´¦æˆ·
- é…ç½® API è®¾ç½®

#### 2. å¸¸ç”¨ç®¡ç†å‘½ä»¤
```bash
# æŸ¥çœ‹åº”ç”¨æ—¥å¿—
sudo tail -f /opt/geo-insight/logs/supervisor_error.log

# é‡å¯åº”ç”¨
sudo supervisorctl restart geo-insight

# é‡å¯ Nginx
sudo systemctl restart nginx

# æŸ¥çœ‹æ•°æ®åº“
sudo -u geo-insight sqlite3 /opt/geo-insight/app/geo_insight.db
```

#### 3. æ›´æ–°åº”ç”¨
```bash
# åœæ­¢åº”ç”¨
sudo supervisorctl stop geo-insight

# å¤‡ä»½æ•°æ®åº“
sudo cp /opt/geo-insight/app/geo_insight.db /opt/geo-insight/backup/

# æ›´æ–°ä»£ç ï¼ˆæ ¹æ®æ‚¨çš„æ–¹å¼ï¼‰
# é‡å¯åº”ç”¨
sudo supervisorctl start geo-insight
```

### ğŸ†˜ æ•…éšœæ’é™¤

#### å¸¸è§é—®é¢˜åŠè§£å†³æ–¹æ¡ˆ

1. **è„šæœ¬æ‰§è¡Œå¤±è´¥**
   ```bash
   # æŸ¥çœ‹è¯¦ç»†é”™è¯¯ä¿¡æ¯
   bash -x deploy.sh
   ```

2. **åº”ç”¨æ— æ³•å¯åŠ¨**
   ```bash
   # æŸ¥çœ‹é”™è¯¯æ—¥å¿—
   sudo tail -f /opt/geo-insight/logs/supervisor_error.log
   ```

3. **æ— æ³•è®¿é—®ç½‘ç«™**
   ```bash
   # æ£€æŸ¥é˜²ç«å¢™
   sudo ufw status
   
   # æ£€æŸ¥ Nginx é…ç½®
   sudo nginx -t
   ```

4. **SSL è¯ä¹¦é—®é¢˜**
   ```bash
   # æ‰‹åŠ¨ç”³è¯·è¯ä¹¦
   sudo certbot --nginx -d your-domain.com
   ```

5. **Pythonå®‰è£…é—®é¢˜**
   ```bash
   # å¦‚æœé‡åˆ° "Unable to locate package python3.9" é”™è¯¯
   # è§£å†³æ–¹æ¡ˆ1: æ‰‹åŠ¨æ·»åŠ PPAæº
   sudo apt update
   sudo apt install -y software-properties-common
   sudo add-apt-repository -y ppa:deadsnakes/ppa
   sudo apt update
   sudo apt install -y python3.9 python3.9-pip python3.9-venv python3.9-dev
   
   # è§£å†³æ–¹æ¡ˆ2: ä½¿ç”¨ç³»ç»Ÿé»˜è®¤Pythonç‰ˆæœ¬ï¼ˆå¦‚æœ3.9ä¸å¯ç”¨ï¼‰
   sudo apt install -y python3 python3-pip python3-venv python3-dev
   # æ£€æŸ¥ç‰ˆæœ¬: python3 --version
   ```

6. **ç¼ºå°‘bcå‘½ä»¤é”™è¯¯**
   ```bash
   # å·²åœ¨æ–°ç‰ˆæœ¬è„šæœ¬ä¸­ä¿®å¤ï¼Œå¦‚æœä»æœ‰é—®é¢˜ï¼š
   sudo apt install -y bc
   ```

### ğŸ“ æŠ€æœ¯æ”¯æŒ

å¦‚æœé‡åˆ°é—®é¢˜ï¼Œè¯·æä¾›ä»¥ä¸‹ä¿¡æ¯ï¼š
1. æœåŠ¡å™¨ç³»ç»Ÿç‰ˆæœ¬ï¼š`cat /etc/os-release`
2. é”™è¯¯æ—¥å¿—å†…å®¹
3. å…·ä½“çš„é”™è¯¯æ­¥éª¤
4. æœåŠ¡å™¨é…ç½®ä¿¡æ¯

---

**å‡†å¤‡å¥½ä»¥ä¸Šå†…å®¹åï¼Œå°±å¯ä»¥å¼€å§‹ä¸€é”®éƒ¨ç½²äº†ï¼** ğŸ‰
